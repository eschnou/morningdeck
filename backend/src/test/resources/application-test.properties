# Test configuration - DataSource auto-configured by @ServiceConnection

# JPA Configuration
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=validate

# HikariCP - connection validation for test stability
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.validation-timeout=5000
spring.datasource.hikari.connection-test-query=SELECT 1
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.maximum-pool-size=5

# Enable Flyway for tests
spring.flyway.enabled=true
spring.flyway.baseline-on-migrate=true
spring.flyway.locations=classpath:db/migrations

# JWT configuration for tests
spring.security.jwt.secret=d2VsbCB0aGlzIGlzIGEgdmVyeSBsb25nIHNlY3JldCBrZXkgZm9yIHRlc3Rpbmc=
spring.security.jwt.expiration=3600000

# Logging for tests
logging.level.org.springframework.security=DEBUG
logging.level.org.testcontainers=INFO
logging.level.com.github.dockerjava=WARN

# Application
application.display-name=Morning Deck
application.root-domain=http://test.example.com
application.root-url=http://test.example.com

# Inbound email - disabled for tests
application.email.provider=none
spring.cloud.aws.sqs.enabled=false

# Storage
application.storage.provider=local
application.upload-folder=${java.io.tmpdir}/barebone-test-uploads

# Test email configuration
application.email.sender=smtp
application.email.test.recipient=e2e-test@transcode.be
application.email.from=noreply@transcode.be
application.email.domain=transcode.be

# Jakarta configuration
smtp.host=localhost
smtp.port=3025
smtp.username=user
smtp.password=password
smtp.from=noreply@transcode.be

# Greenmail configuration
spring.mail.host=localhost
spring.mail.port=3025
spring.mail.username=user
spring.mail.password=password
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true

# Amplitude
analytics.provider=logs

# Disable email verification for tests
application.email.verification.enabled=false

# Allow localhost for WireMock tests
app.security.allow-localhost=true

# Disable scheduled jobs during tests
application.jobs.feed-ingestion.enabled=false
application.jobs.news-processing.enabled=false
application.jobs.briefing-execution.enabled=false

# Use mock AI provider for tests
application.ai.provider=mock
