# Docker Self-Hosting Profile
# Use this profile for self-hosted deployments via docker-compose.selfhost.yml

# Server Configuration
server.port=8080

# Application configuration
application.root-domain=${APP_DOMAIN:localhost:8080}
application.root-url=${APP_URL:http://localhost:8080}
application.log-folder=/app/logs
application.upload-folder=/app/files

# CORS configuration
application.cors.allowed-origins=${CORS_ALLOWED_ORIGINS:http://localhost:8080}

# Database Configuration (docker-compose internal network)
spring.datasource.url=jdbc:postgresql://${DB_HOST:db}:5432/${DB_NAME:morningdeck}
spring.datasource.username=${DB_USERNAME:postgres}
spring.datasource.password=${DB_PASSWORD:postgres}

# Flyway
spring.flyway.enabled=true

# AWS - disabled for self-hosting
spring.cloud.aws.sqs.enabled=false
spring.cloud.aws.credentials.instance-profile=false

# Storage - use local file system for self-hosting
application.storage.provider=local
application.storage.s3.bucket=disabled

# Email - log only for self-hosting (no email sending)
application.email.sender=logs
application.email.from=noreply@localhost

# Email receiving - disabled for self-hosting
application.email.provider=none
application.email.domain=localhost
application.email.sqs.queue-name=disabled
application.email.s3.bucket-name=disabled

# Generation queue - disabled for self-hosting (not using SQS)
application.generation.sqs.queue-name=disabled
application.generation.sqs.queue-url=disabled

# Email verification - disabled for self-hosting (simplifies setup)
application.email.verification.enabled=false

# Self-hosted mode - shows login as landing page instead of commercial landing
application.self-hosted-mode=true

# Closed beta - disabled for self-hosting
application.closed-beta=false

# Core Engine Jobs Configuration - enabled with minimal resources
application.jobs.feed-ingestion.enabled=true
application.jobs.feed-ingestion.worker-count=2
application.jobs.feed-ingestion.queue-capacity=500
application.jobs.feed-ingestion.batch-size=50

application.jobs.news-processing.enabled=true
application.jobs.news-processing.worker-count=1
application.jobs.news-processing.queue-capacity=100
application.jobs.news-processing.batch-size=20

application.jobs.briefing-execution.enabled=true
application.jobs.briefing-execution.queue-capacity=50
application.jobs.briefing-execution.worker-count=1

# ===========================================
# OpenAI / LLM Configuration
# ===========================================
# These can be configured via environment variables to use:
# - OpenAI API: https://api.openai.com/v1 (default)
# - OpenRouter: https://openrouter.ai/api/v1
# - Ollama: http://localhost:11434/v1
# - Any OpenAI-compatible API

# Spring AI OpenAI Configuration
spring.ai.openai.chat.enabled=true
spring.ai.openai.api-key=${OPENAI_API_KEY:your-api-key-here}
spring.ai.openai.base-url=${OPENAI_BASE_URL:https://api.openai.com}
spring.ai.openai.chat.options.model=${OPENAI_MODEL_LITE:gpt-4o-mini}

# AI Provider Configuration
application.ai.provider=openai
application.ai.models.lite=${OPENAI_MODEL_LITE:gpt-4o-mini}
application.ai.models.heavy=${OPENAI_MODEL_HEAVY:gpt-4o}

# ===========================================
# Optional Features - Disabled by Default
# ===========================================

# Meilisearch - disabled for self-hosting (optional)
meilisearch.enabled=${MEILISEARCH_ENABLED:false}
meilisearch.host=${MEILISEARCH_HOST:http://meilisearch:7700}
meilisearch.api-key=${MEILISEARCH_API_KEY:}

# Web Content Fetching - enabled (for full article retrieval)
application.web-fetch.enabled=true
application.web-fetch.timeout-seconds=15
application.web-fetch.user-agent=MorningDeck/1.0

# Reddit API - optional (provide credentials to enable)
application.reddit.client-id=${REDDIT_CLIENT_ID:}
application.reddit.client-secret=${REDDIT_CLIENT_SECRET:}
application.reddit.user-agent=MorningDeck/1.0
application.reddit.default-limit=25
application.reddit.max-age-hours=24

# Actuator - expose health endpoint for Docker health checks
management.endpoints.web.exposure.include=health
management.endpoint.health.show-details=never

# Logging - JSON format for Docker
logging.format=json
