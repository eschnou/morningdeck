spring.application.name=morningdeck-backend

# Server Configuration
server.port=8080
server.error.whitelabel.enabled=false
spring.servlet.multipart.max-file-size=20MB
spring.servlet.multipart.max-request-size=20MB

# Application configuration
application.display-name=Morning Deck
application.root-domain=${APP_DOMAIN}
application.root-url=${APP_URL}
application.log-folder=/morningdeck/logs
application.upload-folder=/morningdeck/files

# CORS configuration (comma-separated list of allowed origins for production)
application.cors.allowed-origins=${CORS_ALLOWED_ORIGINS:}

# Database Configuration
spring.datasource.url=jdbc:postgresql://${DB_HOST}:5432/${DB_NAME}
spring.datasource.username=${DB_USERNAME}
spring.datasource.password=${DB_PASSWORD}
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA Configuration
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect

# Connection Pool Configuration
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.idle-timeout=300000

# Flyway Configuration
spring.flyway.enabled=true
spring.flyway.baseline-on-migrate=true
spring.flyway.locations=classpath:db/migrations
spring.flyway.schemas=public
spring.flyway.baseline-version=0

# Meilisearch Configuration (disabled by default for self-hosted deployments)
meilisearch.enabled=${MEILISEARCH_ENABLED:false}
meilisearch.host=${MEILISEARCH_HOST:http://localhost:7700}
meilisearch.api-key=${MEILISEARCH_API_KEY:}
meilisearch.index-name=news_items

# JWT Configuration
# 256-bit secret key - you should generate a secure one for production
spring.security.jwt.secret=dGVzdC1qd3Qtc2VjcmV0LWtleS1sb2NhbC1kZXZlbG9wbWVudA
# Token validity: 24 hours in milliseconds
spring.security.jwt.expiration=604800000

# Logging Configuration
spring.main.banner-mode=off
logging.config=classpath:logback-spring.xml
logging.format=json
logging.level.root=INFO
logging.level.be.transcode=DEBUG
logging.level.org.opengpa=DEBUG

# Jackson Configuration
spring.jackson.serialization.write-dates-as-timestamps=false
spring.jackson.serialization.fail-on-empty-beans=false
spring.jackson.deserialization.fail-on-unknown-properties=false
spring.jackson.mapper.accept-case-insensitive-enums=true
spring.jackson.time-zone=UTC

# Swagger
springdoc.api-docs.path=/api-docs

# Error Handling
server.error.include-message=always
server.error.include-binding-errors=always
server.error.include-stacktrace=never

# Spring AI - OpenAI compatible configuration
# Supports OpenAI, OpenRouter, Ollama, or any OpenAI-compatible API
spring.ai.openai.chat.enabled=true
spring.ai.openai.api-key=${OPENAI_API_KEY}
spring.ai.openai.base-url=${OPENAI_BASE_URL:https://api.openai.com}
spring.ai.openai.chat.options.model=${OPENAI_MODEL_LITE:gpt-4o-mini}

# AI Provider
application.ai.provider=openai
application.ai.models.lite=${OPENAI_MODEL_LITE:gpt-4o-mini}
application.ai.models.heavy=${OPENAI_MODEL_HEAVY:gpt-4o}

# AWS Region Configuration
spring.cloud.aws.region.static=eu-west-1

# AWS Credentials
spring.cloud.aws.credentials.instance-profile=true

# SQS Configuration
spring.cloud.aws.sqs.endpoint=https://sqs.${spring.cloud.aws.region.static}.amazonaws.com
spring.cloud.aws.sqs.listener.max-number-of-messages=10
spring.cloud.aws.sqs.listener.wait-timeout=20
spring.cloud.aws.sqs.listener.visibility-timeout=300

# S3 configuration
application.storage.provider=s3
application.storage.s3.bucket=${S3_FILES_BUCKET}

# Email send configuration
application.email.sender=aws
application.email.from=noreply@${APP_DOMAIN}

# Inbound emails
application.email.provider=sqs
application.email.domain=${EMAIL_DOMAIN}
application.email.sqs.queue-name=${EMAIL_SQS_QUEUE_NAME}
application.email.s3.bucket-name=${EMAIL_S3_BUCKET_NAME}

# Email verification
application.email.verification.enabled=true
application.email.verification.expiration-hours=24

# Closed beta (invite codes are now managed in the database)
application.closed-beta=false

# Core Engine Jobs Configuration
application.jobs.feed-ingestion.enabled=true
application.jobs.feed-ingestion.queue-capacity=1000
application.jobs.feed-ingestion.worker-count=4
application.jobs.feed-ingestion.batch-size=100
application.jobs.feed-ingestion.stuck-threshold-minutes=10
application.jobs.feed-scheduling.interval=60000
application.jobs.feed-recovery.interval=300000
application.jobs.news-processing.enabled=true
application.jobs.news-processing.queue-capacity=500
application.jobs.news-processing.worker-count=2
application.jobs.news-processing.batch-size=50
application.jobs.news-processing.interval=60000
application.jobs.news-processing.stuck-threshold-minutes=10
application.jobs.news-processing.recovery-interval=300000
application.jobs.briefing-execution.enabled=true
application.jobs.briefing-execution.queue-capacity=100
application.jobs.briefing-execution.worker-count=1
application.jobs.briefing-execution.interval=60000
application.jobs.briefing-execution.stuck-threshold-minutes=15
application.jobs.briefing-execution.recovery-interval=300000

# Web Content Fetching
application.web-fetch.enabled=true
application.web-fetch.timeout-seconds=15
application.web-fetch.user-agent=MorningDeck/1.0

# Reddit API Configuration
application.reddit.client-id=${REDDIT_CLIENT_ID:}
application.reddit.client-secret=${REDDIT_CLIENT_SECRET:}
application.reddit.user-agent=MorningDeck/1.0
application.reddit.default-limit=25
application.reddit.max-age-hours=24
